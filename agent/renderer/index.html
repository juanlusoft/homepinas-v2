<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HomePiNAS Backup</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Step 1: Connect to NAS -->
  <div id="step-connect" class="step active">
    <div class="logo">ğŸ </div>
    <h1>HomePiNAS Backup</h1>
    <p class="subtitle">Conecta con tu NAS para proteger tu equipo</p>

    <button id="btn-discover" class="btn btn-primary btn-large">ğŸ” Buscar NAS en mi red</button>

    <div id="discover-results" class="hidden">
      <div id="nas-list"></div>
    </div>

    <div class="auth-section" id="auth-section" style="display:none; margin-top: 20px;">
      <p>Introduce tus credenciales del dashboard:</p>
      <div class="input-row" style="flex-direction: column; gap: 8px;">
        <input type="text" id="nas-user" placeholder="Usuario" style="width:100%">
        <input type="password" id="nas-pass" placeholder="ContraseÃ±a" style="width:100%">
        <button id="btn-auth-connect" class="btn btn-primary">Conectar</button>
      </div>
    </div>

    <div class="manual-connect">
      <p>O introduce la direcciÃ³n manualmente:</p>
      <div class="input-row">
        <input type="text" id="nas-address" placeholder="192.168.1.x">
        <input type="number" id="nas-port" value="443" style="width:80px">
        <button id="btn-connect" class="btn">Conectar</button>
      </div>
    </div>
  </div>

  <!-- Step 2: Waiting for approval -->
  <div id="step-pending" class="step hidden">
    <div class="logo">â³</div>
    <h1>Esperando aprobaciÃ³n</h1>
    <p class="subtitle">Tu equipo se ha registrado en el NAS.</p>
    <p>El administrador del NAS debe aprobar este dispositivo desde el panel de Active Backup.</p>
    <div class="pending-info">
      <div class="spinner"></div>
      <p>Comprobando cada minuto...</p>
    </div>
  </div>

  <!-- Step 3: Dashboard (approved) -->
  <div id="step-dashboard" class="step hidden">
    <div class="dash-header">
      <h1>ğŸ›¡ï¸ Backup activo <span id="dash-version" class="version-badge"></span></h1>
      <span id="dash-nas" class="badge">NAS: â€”</span>
    </div>

    <div class="dash-cards">
      <div class="card">
        <div class="card-icon" id="dash-status-icon">â¸ï¸</div>
        <div class="card-label">Estado</div>
        <div class="card-value" id="dash-status">En espera</div>
      </div>
      <div class="card">
        <div class="card-icon">ğŸ“…</div>
        <div class="card-label">Ãšltimo backup</div>
        <div class="card-value" id="dash-last">Nunca</div>
      </div>
      <div class="card">
        <div class="card-icon">â°</div>
        <div class="card-label">ProgramaciÃ³n</div>
        <div class="card-value" id="dash-schedule">â€”</div>
      </div>
      <div class="card">
        <div class="card-icon">ğŸ’¾</div>
        <div class="card-label">Tipo</div>
        <div class="card-value" id="dash-type">â€”</div>
      </div>
    </div>

    <div id="dash-progress" class="progress-bar hidden">
      <div class="progress-header">
        <span id="progress-phase">Iniciando...</span>
        <span id="progress-pct">0%</span>
      </div>
      <div class="progress-track">
        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
      </div>
      <div id="progress-detail" class="progress-detail"></div>
    </div>

    <div id="dash-error-bar" class="error-bar hidden">
      <span id="dash-error-text"></span>
    </div>

    <div class="dash-actions">
      <button id="btn-backup-now" class="btn btn-primary">â–¶ Hacer backup ahora</button>
      <button id="btn-disconnect" class="btn btn-danger">Desconectar</button>
    </div>
    <div class="dash-actions" style="margin-top: 4px;">
      <button id="btn-open-log" class="btn btn-small">ğŸ“„ Ver log</button>
      <button id="btn-open-folder" class="btn btn-small">ğŸ“‚ Carpeta logs</button>
    </div>
  </div>

  <!-- Loading overlay -->
  <div id="loading" class="hidden">
    <div class="spinner"></div>
    <p id="loading-text">Cargando...</p>
  </div>

  <script src="app.js"></script>
</body>
</html>
